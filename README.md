# Калькулятор обратной польской нотации (M3)

## Описание

Этот проект представляет собой реализацию калькулятора, работающего по принципу обратной польской нотации (ОПН). Калькулятор поддерживает основные арифметические операции и обработку вложенных выражений с помощью скобок.

## Основные возможности

- **Арифметические операции**:
  - Сложение (`+`)
  - Вычитание (`-`)
  - Умножение (`*`)
  - Деление (`/`)
  - Возведение в степень (`**`)

- **Обработка скобок**: поддержка вложенных выражений любой глубины
- **Обработка ошибок**: различные типы исключений для разных ситуаций
- **Интерактивный режим**: работа в диалоговом режиме с пользователем

## Особенности реализации

- Рекурсивная обработка вложенных выражений
- Токенизация входной строки
- Стек для хранения промежуточных результатов
- Детальная обработка ошибок:
  - Неправильные токены
  - Несбалансированные скобки
  - Неправильное количество операндов
  - Деление на ноль

## Структура проекта

```
├── src/
|   ├── main.py          # Главный файл для запуска калькулятора
│   ├── calc.py          # Основная логика калькулятора
│   └── exceptions.py    # Пользовательские исключения
└── tests/
    └── test_rpn_calculator.py  # Модульные тесты
```

## Использование

### Запуск калькулятора

```bash
python main.py
```

### Примеры выражений

- Простые операции:
  ```
  > 2 3 +
  5.0
  ```

- Выражения со скобками:
  ```
  > 2 ( 3 4 + ) *
  14.0
  ```

- Сложные вложенные выражения:
  ```
  > 420 ( 1337 420 ( 63 6 + ) + - ) ( 2 10 ** ) ( 28 7 / ) - * -
  -864540.0
  ```

### Выход из программы

Для выхода введите `q` или `Q`.

## Классы исключений

- `RPNError` - базовая ошибка калькулятора
- `InvalidTokenError` - неверный токен во входной строке
- `TooManyOperandsError` - недостаточно операндов для операции
- `NotEnoughOperandsError` - в стеке остались лишние значения
- `WrongBracketCombinationError` - неправильная расстановка скобок

## Тестирование

Для запуска тестов выполните:

```bash
python -m unittest tests/test_rpn_calculator.py
```

Тесты покрывают:
- Все арифметические операции
- Обработку скобок
- Обработку ошибок
- Граничные случаи

## Принцип работы

1. **Токенизация**: Входная строка разбивается на токены (числа, операторы, скобки)
2. **Обработка токенов**:
   - Числа помещаются в стек
   - Операторы извлекают операнды из стека и помещают результат обратно
   - Скобки обрабатываются рекурсивно с созданием под-калькулятора
3. **Результат**: После обработки всех токенов в стеке должен остаться один элемент - результат вычислений
